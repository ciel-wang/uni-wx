(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"153c":function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return u}));var u={uIcon:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(t.bind(null,"1e79"))},uImage:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-image/u-image")]).then(t.bind(null,"a083"))},"u-Image":function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u--image/u--image")]).then(t.bind(null,"d648"))},myCard:function(){return t.e("components/my-card").then(t.bind(null,"2227"))},uGrid:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-grid/u-grid")]).then(t.bind(null,"25f0"))},uGridItem:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-grid-item/u-grid-item")]).then(t.bind(null,"6ef2"))},uBadge:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-badge/u-badge")]).then(t.bind(null,"3155"))},uPopup:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(t.bind(null,"3d93"))},uSearch:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-search/u-search")]).then(t.bind(null,"424e"))},uList:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-list/u-list")]).then(t.bind(null,"5746"))},uListItem:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-list-item/u-list-item")]).then(t.bind(null,"36e5"))},uCell:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-cell/u-cell")]).then(t.bind(null,"0137"))},myCountdownLogin:function(){return t.e("components/my-countdown-login").then(t.bind(null,"9101"))},uOverlay:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-overlay/u-overlay")]).then(t.bind(null,"3776"))},uTabbar:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-tabbar/u-tabbar")]).then(t.bind(null,"2e5b"))},uTabbarItem:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-tabbar-item/u-tabbar-item")]).then(t.bind(null,"ef6a"))}},o=function(){var e=this,n=e.$createElement,t=(e._self._c,e.noticeList.length),u=e.noticeList.length,o=e.noticeList.length;e._isMounted||(e.e0=function(n){e.selectSchoolShow=!1}),e.$mp.data=Object.assign({},{$root:{g0:t,g1:u,g2:o}})},i=[]},"1a4e":function(e,n,t){"use strict";t.r(n);var u=t("7712"),o=t.n(u);for(var i in u)["default"].indexOf(i)<0&&function(e){t.d(n,e,(function(){return u[e]}))}(i);n["default"]=o.a},"258e":function(e,n,t){},"35d7":function(e,n,t){"use strict";var u=t("258e"),o=t.n(u);o.a},"5e18":function(e,n,t){"use strict";(function(e,n){var u=t("4ea4");t("5495");u(t("66fd"));var o=u(t("9b9a"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(o.default)}).call(this,t("bc2e")["default"],t("543d")["createPage"])},7712:function(e,n,t){"use strict";(function(e,u){var o=t("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t("2eee")),a=o(t("278c")),r=o(t("c973")),s=t("25d6"),c=t("55ed"),l=t("38b8");function d(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return f(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var u=0,o=function(){};return{s:o,n:function(){return u>=e.length?{done:!0}:{done:!1,value:e[u++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,r=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){r=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(r)throw i}}}}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,u=new Array(n);t<n;t++)u[t]=e[t];return u}var v={data:function(){return{topImg:"",empName:"",isAM:!0,noticeList:[],news:"",selectSchoolShow:!1,schoolName:"",slogo:"",sid:"",schoolList:[],isBind:"",applicationList:[],applicateKey:[],voiceModalShow:!1,iconArr:l.iconArr}},onLoad:function(){var n=this;this.$u.vuex("vuex_windowHeight",e.getSystemInfoSync().windowHeight),this.applicateKey=this.vuex_selectMenuKey||[],this.applicationList=(0,l.filterApplicate)(this.applicateKey),(0,s.getSchoolList)().then((function(e){var t=e.data.data;if(n.schoolList=t,n.vuex_urlobj.sid){var u=t.filter((function(e){return e.sid==n.vuex_urlobj.sid}));n.schoolName=u.length&&u[0].sname||"",n.slogo=u.length&&u[0].slogo||"",n.sid=u.length&&u[0].sid||""}if(!n.schoolName&&1===t.length){var o=t[0],i=o.sname,a=o.sid,r=o.slogo;n.schoolName=i,n.slogo=r,n.sid=a,n.$u.vuex("vuex_urlobj.sid",a)}n.initPage()}))},onShow:function(){var e;this.isBind=this.vuex_urlobj.isBind||0,this.isAM=(new Date).getHours()<12,this.empName=(null===(e=this.vuex_useInfo)||void 0===e?void 0:e.empName)||"",1==this.vuex_urlobj.isBind&&this.showFun(),console.log("indexpage______onshow")},methods:{voiceTouchstart:function(){this.voiceModalShow=!0;var e=u.getRecorderManager();e.start()},voiceTouchend:function(){this.voiceModalShow=!1;var e=u.getRecorderManager();e.onStop({success:function(e){e.tempFilePath}})},getVoiceData:function(e){var n=this;(0,c.reqVoiceInfo)({content:e}).then((function(e){var t=e.data.data,u=t.executeScript,o=t.pagePath,i=t.menuKey,a=u?o+(o.indexOf("?")<0?"?":"&")+"executeScript="+u:o;n.urlItemClick(i,a)})).catch((function(e){return n.$u.toast(e)}))},getMenuAuthData:function(){var n=this;return new Promise((function(t,u){(0,s.getMunuAuth)().then((function(e){var u=e.data.data.map((function(e){return{key:e.menu_key,display:e.display,enable:e.enable,type:e.menu_type}}));if(n.$u.vuex("vuex_menuAuth",u),!n.applicateKey.length){var o=u.filter((function(e){return e.enable&&e.display}));n.applicateKey=o.map((function(e){return e.key})).slice(0,11),n.applicationList=(0,l.filterApplicate)(n.applicateKey),n.$u.vuex("vuex_selectMenuKey",n.applicateKey)}t()})).catch((function(u){n.$u.vuex("vuex_menuAuth",[]),e.$u.toast(u),t()}))}))},schoolListClick:function(n){var t=n.sname,u=n.sid,o=n.slogo;this.schoolName=t,this.slogo=o,this.sid=u,e.removeStorageSync("vuex_cfg"),e.removeStorageSync("vuex_useInfo"),e.removeStorageSync("vuex_menuAuth"),this.$u.vuex("vuex_urlobj.sid",u),this.selectSchoolShow=!1,this.initPage()},schoolChange:function(){1!==this.schoolList.length&&(this.selectSchoolShow=!0)},initPage:function(){var n=this;return(0,r.default)(i.default.mark((function t(){var u,o,a;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if((0,s.reqBasicInfo)().then((function(e){var t=e.data.data,u=t.banners&&t.banners.split(",")||[];n.topImg=u.length&&u[0],t.empInfo.faceUrl=t.empInfo.avatarUrl,n.$u.vuex("vuex_wxInfo",t.empInfo),n.$u.vuex("vuex_cfg.subsidy1",e.data.data.WALLET_SUBSIDY1_START),n.$u.vuex("vuex_cfg.subsidy2",e.data.data.WALLET_SUBSIDY2_START),n.$u.vuex("vuex_cfg.subsidy3",e.data.data.WALLET_SUBSIDY3_START),n.$u.vuex("vuex_cfg.czMax",e.data.data.CZ_SIGNLE_MAX_MONEY),n.$u.vuex("vuex_cfg.personWallet",e.data.data.WALLET_PERSONAL_START)})),n.vuex_urlobj.openid){t.next=7;break}return t.next=4,n.wxLogin();case 4:return o=t.sent,t.next=7,(0,s.getWxInfo)({code:o}).then((function(e){var t=e.data.data;n.$u.vuex("vuex_urlobj.openid",t.openid),n.$u.vuex("vuex_urlobj.sessionKey",t.sessionKey)}));case 7:return t.next=9,(0,s.getToken)({wxId:n.vuex_urlobj.bindWxId||0}).catch((function(t){n.$u.vuex("vuex_urlobj.token",""),n.$u.vuex("vuex_urlobj.isBind",0),n.isBind=0,e.$u.toast(t)}));case 9:a=t.sent,200==(null===a||void 0===a||null===(u=a.data)||void 0===u?void 0:u.code)&&(n.$u.vuex("vuex_urlobj.token",a.data.data.accessToken),n.$u.vuex("vuex_urlobj.isBind",1),n.isBind=1),(0,s.initFkCfg)().then((function(e){200==e.data.code&&(n.$u.vuex("vuex_cfg.dateType",e.data.data.FK_YUYUE_DATE_OR_DATETIME_OPTIONS||"date"),n.$u.vuex("vuex_cfg.isShowSourceAddr",e.data.data.VISITOR_IS_START_SOURCE_ADDRESS||1),n.$u.vuex("vuex_cfg.isShowCertificate",e.data.data.VISITOR_IS_UPLOAD_CERTIFICATE||0))})),n.showFun();case 13:case"end":return t.stop()}}),t)})))()},showFun:function(){var e=this;return(0,r.default)(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getMenuAuthData();case 2:e.vuex_urlobj.token?(0,c.userInfo)().then((function(n){var t=n.data.data;e.empName=t.empName,e.$u.vuex("vuex_urlobj.bindWxId",t.wxId),e.$u.vuex("vuex_useInfo",t)})).catch((function(){e.$u.vuex("vuex_useInfo",{}),e.empName=""})):(e.empName="",e.$u.vuex("vuex_useInfo",{}));case 3:case"end":return n.stop()}}),n)})))()},wxLogin:function(){return new Promise((function(e,n){u.login({success:function(n){var t=n.code;return e(t)},fail:function(e){return n(e)}})}))},getUrlParams:function(e){var n=e.indexOf("?");-1!==n&&(e=e.slice(n+1));var t,u=new URLSearchParams(e),o={},i=d(u);try{for(i.s();!(t=i.n()).done;){var r=(0,a.default)(t.value,2),s=r[0],c=r[1];o[s]=c}}catch(l){i.e(l)}finally{i.f()}return o},handlerTabbar:function(n){n!=this.tabbarIndex&&e.switchTab({url:"/pages/home/home"})},urlItemClick:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("all"!==n){if(!this.sid)return this.$u.toast("请先选择学校"),void(this.selectSchoolShow=!0);var u=(0,l.getItemAuth)(n);if(!u||0==u.enable)return this.$u.toast("此功能暂未开放");var o=(0,l.filterApplicate)([n]);o.length&&(u.url=o[0].url),u&&t&&(u.url=t),console.log(u,this.isBind,this.vuex_urlobj.isBind);var i=["FK_APPOINTMENT","FK_RESERVATION_RECORD"];if(i.includes(n))return"FK_APPOINTMENT"===u.key&&1==this.isBind&&2==this.vuex_useInfo.bindEmpType?this.$u.toast("此功能暂未开放"):this.$u.route(u.url);if(0==this.isBind)return this.$refs.mycountdownloginRef.start();var a=["FK_INVITATION","FK_INVITATION_RECORD","SP_EVECTION","SP_OVERTIME","SP_RETROACTIVE_RECORD"];if(a.includes(n)&&2!=this.vuex_useInfo.bindEmpType)return this.$u.toast("此功能暂未开放");this.$u.route(u.url)}else e.redirectTo({url:"/pages/home/app-manager/app-manager"})}}};n.default=v}).call(this,t("543d")["default"],t("bc2e")["default"])},"9b9a":function(e,n,t){"use strict";t.r(n);var u=t("153c"),o=t("1a4e");for(var i in o)["default"].indexOf(i)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(i);t("35d7");var a=t("f0c5"),r=Object(a["a"])(o["default"],u["b"],u["c"],!1,null,null,null,!1,u["a"],void 0);n["default"]=r.exports}},[["5e18","common/runtime","common/vendor"]]]);