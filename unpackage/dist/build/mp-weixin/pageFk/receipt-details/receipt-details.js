require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pageFk/receipt-details/receipt-details"],{5297:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return o}));var o={uIcon:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(i.bind(null,"1e79"))},myCard:function(){return i.e("components/my-card").then(i.bind(null,"2227"))},uAvatar:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-avatar/u-avatar")]).then(i.bind(null,"b1e7"))},uCellGroup:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-cell-group/u-cell-group")]).then(i.bind(null,"f7ef"))},uCell:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-cell/u-cell")]).then(i.bind(null,"0137"))},myButton:function(){return i.e("components/my-button").then(i.bind(null,"e84c"))},uPopup:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(i.bind(null,"3d93"))},uForm:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-form/u-form")]).then(i.bind(null,"ff33"))},uFormItem:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-form-item/u-form-item")]).then(i.bind(null,"f4f7"))},uInput:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-input/u-input")]).then(i.bind(null,"f18a"))},uModal:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-modal/u-modal")]).then(i.bind(null,"071d"))},uOverlay:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-overlay/u-overlay")]).then(i.bind(null,"3776"))},uToast:function(){return i.e("uni_modules/uview-ui/components/u-toast/u-toast").then(i.bind(null,"b688"))}},n=function(){var t=this,e=t.$createElement,i=(t._self._c,t.formInfo.visitors.length),o="appointment"===t.sourcePage&&(2!=t.vuex_useInfo.bindEmpType||t.isNoticTarget)&&"3"==t.visitorState&&(new Date).getTime()<new Date(t.iosTransDate(t.formInfo.visitorTime)).getTime(),n=2==t.formInfo.receiptsType&&"3"==t.visitorState&&(new Date).getTime()<new Date(t.iosTransDate(t.formInfo.visitorTime)).getTime();t._isMounted||(t.e0=function(e){t.popupFormShow=!1},t.e1=function(e){t.visitorLineIdShow=!0},t.e2=function(e){t.confirmShow=!1}),t.$mp.data=Object.assign({},{$root:{g0:i,g1:o,g2:n}})},s=[]},"66f6":function(t,e,i){"use strict";(function(t){var o=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i("9523")),s=o(i("9332")),r=i("d0bf");function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}var a={components:{multipleSelect:function(){Promise.all([i.e("common/vendor"),i.e("pageFk/momo-multipleSelect/momo-multipleSelect")]).then(function(){return resolve(i("c1c9"))}.bind(null,i)).catch(i.oe)}},data:function(){return{formInfo:{visitorQrCode:"123456",visitorCardNum:"visitorCardNum",visitors:[],visitorsArr:[],staticPrefix:""},visitorNo:"1234561",stateIcon:"",stateColor:"",visitorState:"",popupFormShow:!1,form:{},submitMaskShow:!1,confirmShow:!1,confirmContent:"",btnType:"",sourcePage:"",isNoticTarget:!1,isAuthBtn:!0,visitorLineIdShow:!1,visitorLineDic:[]}},onLoad:function(t){this.visitorNo=t.visitorNo,this.isNoticTarget=!!t.type,this.sourcePage=t.sourcePage?t.sourcePage:"targetVisitor"===t.type?"targetInvite":"appointment",this.initData()},methods:{handleView:function(){if(0!==this.formInfo.visitorsArr.length){var t=2!=this.vuex_useInfo.bindEmpType&&"appointment"===this.sourcePage&&("3"==this.visitorState||"5"==this.visitorState||"6"==this.visitorState)&&1==this.formInfo.receiptsType;this.$u.route("/pageFk/visitorEmpInfoDetails/visitorEmpInfoDetails",{visitorNo:this.visitorNo,isShowQrcode:t?1:0})}},handleConfirm:function(){var t=this;if(this.confirmShow=!1,"cancel"===this.btnType){var e={};e["visitorNo"]=this.visitorNo,e["targetEmpPhone"]=this.formInfo.targetEmpPhone,this.submitMaskShow=!0,(0,r.cancel)(e).then((function(e){t.submitMaskShow=!1,t.$refs.uToast.show({message:e.data.msg,type:"success"}),setTimeout((function(){t.backClick()}),2e3),t.initData()})).catch((function(e){t.submitMaskShow=!1,t.$refs.uToast.show({message:e,type:"error"})}))}},targetInviteBtnClick:function(t){"left"===t?this.cancelClick():8==this.visitorState?this.receiptSubmit():(this.btnType="targetInviteAgree",this.popupFormShow=!0)},visitorBtnClick:function(t){var e=this;if("left"===t)this.cancelClick();else if(8==this.visitorState)this.receiptSubmit();else{var i={};i["visitorNo"]=this.visitorNo,this.submitMaskShow=!0,(0,r.resubmit)(i).then((function(t){e.submitMaskShow=!1,e.$refs.uToast.show({message:t.data.msg,type:"success"}),setTimeout((function(){e.backClick()}),2e3),e.initData()})).catch((function(t){e.submitMaskShow=!1,e.$refs.uToast.show({message:t,type:"error"})}))}},receiptSubmit:function(){var t=this;this.submitMaskShow=!0,(0,r.immediateSubmit)({visitorNo:this.visitorNo}).then((function(e){t.submitMaskShow=!1,t.$refs.uToast.show({message:e.data.msg,type:"success"}),setTimeout((function(){t.backClick()}),2e3)})).catch((function(e){t.submitMaskShow=!1,t.$refs.uToast.show({message:e,type:"error"})}))},cancelClick:function(){this.btnType="cancel",this.confirmContent="确定要取消".concat(1==this.formInfo.receiptsType?"预约":"邀约","？"),this.confirmShow=!0},targetBtnClick:function(t){this.btnType="left"===t?"targetCancel":"targetAgree",this.popupFormShow=!0},formSubmit:function(){var t=this;if(!this.form.rejectCause&&"targetCancel"===this.btnType)return this.$refs.uToast.show({message:"请输入拒绝原因",type:"warning"});if(!this.form.visitorLineIds&&["targetInviteAgree","targetAgree","reExamination"].includes(this.btnType))return this.$refs.uToast.show({message:"请选择访问线路",type:"warning"});var e={};if(e["visitorNo"]=this.visitorNo,e["targetEmpPhone"]=this.formInfo.targetEmpPhone,this.submitMaskShow=!0,"targetCancel"===this.btnType)return e["rejectCause"]=this.form.rejectCause,void(0,r.auditReject)(e).then((function(e){t.submitMaskShow=!1,t.$refs.uToast.show({message:e.data.msg,type:"success"}),setTimeout((function(){t.backClick()}),2e3),t.initData(),t.popupFormShow=!1})).catch((function(e){t.submitMaskShow=!1,t.$refs.uToast.show({message:e,type:"error"})}));["targetInviteAgree","targetAgree","reExamination"].includes(this.btnType)&&(e["visitorLineIds"]=this.form.visitorLineIds,(0,r.auditConsent)(e).then((function(e){t.submitMaskShow=!1,t.$refs.uToast.show({message:e.data.msg,type:"success"}),setTimeout((function(){t.backClick()}),2e3),t.initData(),t.popupFormShow=!1})).catch((function(e){t.submitMaskShow=!1,t.$refs.uToast.show({message:e,type:"error"})})))},reExaminationClick:function(){this.btnType="reExamination",this.popupFormShow=!0},visitorLineConfirm:function(t){this.form.visitorLine=t.map((function(t){return t.label})).join(","),this.form.visitorLineIds=t.map((function(t){return t.value})).join(",")},initData:function(){var t=this;(0,r.details)({visitorNo:this.visitorNo}).then((function(e){if(200===e.data.code){var i=e.data.data;t.isAuthBtn=0!=i.VISITOR_IS_SHOW_AUDIT_BTN,i.visitorPersonCount=1==i.receiptsType?1*i.visitorPersonCount+1:i.visitorPersonCount;var o=i.visitors.filter((function(t){return t.visitorCertificateCode}));i.visitors=o,i.visitorsArr=o.length>7?o.slice(0,7):o,i.levalTime="datetime"===t.vuex_cfg.dateType?i.levalTime.substr(0,16):i.levalTime.substr(0,10),i.visitorTime="datetime"===t.vuex_cfg.dateType?i.visitorTime.substr(0,16):i.visitorTime.substr(0,10),t.formInfo=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){(0,n.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},i),t.visitorState=i.visitorState,1==i.visitorState?(t.stateIcon="shenpi-daishenhe",t.stateColor="#FF9934"):2==i.visitorState?(t.stateIcon="shenpi-yichexiao",t.stateColor="#BABABA"):3==i.visitorState?(t.stateIcon="shenpi-yitongyi",t.stateColor="#00C431"):4==i.visitorState?(t.stateIcon="shenpi-yijujue",t.stateColor="#FF1400"):5==i.visitorState||6==i.visitorState?(t.stateIcon="shenpi-yitongyi",t.stateColor="#00C431"):71==i.visitorState||72==i.visitorState?(t.stateIcon="shenpi-yichaoshi",t.stateColor="#FF4500"):8==i.visitorState&&(t.stateIcon="yaoqingzhong",t.stateColor="#2DBD90"),(0,r.reqLines)({visitorAreaId:i.visitorAreaId}).then((function(e){if(200==e.data.code){var i=e.data.data.map((function(t){return{value:t.id,label:t.lineName}}));t.visitorLineDic=i}}))}}))},phoneClick:function(e){t.makePhoneCall({phoneNumber:e})},imgClick:function(e){t.previewImage({urls:[this.formInfo.staticPrefix+e]})},copyVisitorNo:function(){(0,s.default)({content:"".concat(this.visitorNo),success:function(e){t.showToast({title:"复制成功",icon:"success",duration:3e3})},error:function(e){t.showToast({title:"复制失败",icon:"error",duration:3e3})}})},backClick:function(){return"appointment"===this.sourcePage?this.$u.route("/pageFk/appointmentrecord/appointmentrecord"):"targetInvite"===this.sourcePage?this.$u.route("/pageFk/inviteRecord/inviteRecord"):void 0}}};e.default=a}).call(this,i("543d")["default"])},a8fd:function(t,e,i){},d2e2:function(t,e,i){"use strict";i.r(e);var o=i("66f6"),n=i.n(o);for(var s in o)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(s);e["default"]=n.a},d841:function(t,e,i){"use strict";var o=i("a8fd"),n=i.n(o);n.a},e00b:function(t,e,i){"use strict";i.r(e);var o=i("5297"),n=i("d2e2");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("d841");var r=i("f0c5"),u=Object(r["a"])(n["default"],o["b"],o["c"],!1,null,"d27ecd2a",null,!1,o["a"],void 0);e["default"]=u.exports},eef9:function(t,e,i){"use strict";(function(t,e){var o=i("4ea4");i("5495");o(i("66fd"));var n=o(i("e00b"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(n.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])}},[["eef9","common/runtime","common/vendor","pageFk/common/vendor"]]]);