require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pageKq/receiptDetail/receiptDetail"],{3724:function(e,t,i){"use strict";i.r(t);var n=i("83a0"),r=i("9725");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);i("cbfb");var u=i("f0c5"),a=Object(u["a"])(r["default"],n["b"],n["c"],!1,null,"46420727",null,!1,n["a"],void 0);t["default"]=a.exports},"58f8":function(e,t,i){"use strict";(function(e){var n=i("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(i("9523")),u=i("ac48"),a=i("25b0");function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var c={data:function(){return{form:{duplicateEmps:[],empName:"",auditEmps:[],createTime:"",receiptImgs:[],receiptTogether:[]},receiptStatus:"",stateIcon:"",stateColor:"",typeRoleTitle:"",receiptCauseTitle:"",who:"",receiptId:"",leave:1,nextAuditEmpId:"",nextAuditEmpName:"",auditStatus:"",togetherName:"",togetherShow:!1,form2:{},formShow:!1,btnType:""}},onLoad:function(e){if(this.who=e.who,this.id=e.id,e.form){var t=JSON.parse(e.form);this.nextAuditEmpId=t[0].auditEmpId,this.nextAuditEmpName=t[0].empName}},onShow:function(){this.initData()},methods:{cancelEditClick:function(t){var i=this;if("left"!==t){var n=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){(0,o.default)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},this.form);n.duplicateEmpList=n.duplicateEmps,n.duplicateEmpIds=n.duplicateEmps.map((function(e){return e.id})).join(","),n.auditEmps.length&&(n.auditEmpIds=n.auditEmps[0].id,n.auditEmpName=n.auditEmps[0].empName),n.receiptImgs=n.receiptImgs&&n.receiptImgs.map((function(e){return n.staticPrefix+e})).join(",");var r=n.jbTimeSteps?n.jbTimeSteps:[];n.jbTimeSteps=r.map((function(e){return{dayDate:e.dayDate?e.dayDate.substr(0,10):"",minute:Number((e.minute/60).toFixed(2))}})),n.endTimeMax=n.startTime?this.$u.timeFormat(new Date((0,u.transDate)(n.startTime)).getTime()+6048e5,"yyyy-mm-dd"):0,n.startTime=n.startTimes,n.endTime=n.endTimee,n.isLeave=n.isLeave?1:0,e.setStorageSync("receiptsForm_key",n),e.navigateTo({url:"../leave/leave?type=".concat(n.receiptType,"&sourceType=edit")})}else(0,a.receiptCancel)({id:this.receiptId}).then((function(t){i.$refs.uToast.show({message:t.data.msg,type:"success"}),setTimeout((function(){e.redirectTo({url:"../oabills/oabills?who=me"})}),1500)})).catch((function(e){i.$refs.uToast.show({message:e,type:"error"})}))},rejectAgreeClick:function(e){this.btnType="left"===e?"reject":"agree",this.formShow=!0},viewImg:function(t){e.previewImage({urls:[t]})},initData:function(){var e=this;(0,a.receiptDetails)({id:this.id}).then((function(t){if(200==t.data.code){var i=t.data.data;if(i.deptName=i.deptName?i.deptName:i.gradeName+i.className,e.receiptId=i.id,i.auditEmps.length){var n=i.auditEmps;n.forEach((function(t){i.currEmpId!=t.id||(e.auditStatus=t.auditStatus)}))}if(i.receiptTogether&&i.receiptTogether.length>0){var r=[];i.receiptTogether.forEach((function(e){r.push(e.empName)})),r.length>3?e.togetherName=r.slice(0,3).join(",")+"等".concat(r.length,"人"):e.togetherName=r.join(",")}if(e.leave=i.leave-i.auditEmps.length,1==i.receiptVehicle&&(i.receiptVehicle1="飞机"),2==i.receiptVehicle&&(i.receiptVehicle1="火车"),3==i.receiptVehicle&&(i.receiptVehicle1="汽车"),4==i.receiptVehicle&&(i.receiptVehicle1="其他"),i.isOneWay?i.isOneWay1="单程":i.isOneWay1="往返",3==i.receiptType?(i.startTimes=i.startTime.substr(0,10),i.startTime=i.startTime.substr(0,10),i.endTime&&(i.endTimee=i.endTime.substr(0,10),i.endTime=i.endTime.substr(0,10))):(i.startTime&&(i.startTimes=i.startTime.substr(0,16)),i.endTime&&(i.endTimee=i.endTime.substr(0,16))),4==i.receiptType&&i.bkTimeSteps){var o=[];i.bkTimeSteps.forEach((function(e){o.push(e.substr(0,16))})),i.bkTimeSteps=o}i.receiptImgs&&i.receiptImgs.length>5?i.receiptImgs=i.receiptImgs.split(","):i.receiptImgs=[],i.duration=(i.duration/60).toFixed(1),2==i.receiptStatus&&(e.stateIcon="shenpi-shenpizhong",e.stateColor="#ff9227"),3==i.receiptStatus&&(e.stateIcon="shenpi-yitongyi",e.stateColor="#00C431"),4==i.receiptStatus&&(e.stateIcon="shenpi-yijujue",e.stateColor="#d81e06"),5==i.receiptStatus&&(e.stateIcon="shenpi-yichexiao",e.stateColor="#cdcdcd"),7==i.receiptStatus&&(e.stateIcon="yizuofei",e.stateColor="#cdcdcd"),e.receiptStatus=i.receiptStatus,1==i.receiptType&&(e.typeRoleTitle="请假类型:",e.receiptCauseTitle="请假事由:"),2==i.receiptType&&(e.typeRoleTitle="出差类型:",e.receiptCauseTitle="出差事由:"),3==i.receiptType&&(e.typeRoleTitle="加班类型:",e.receiptCauseTitle="加班事由:"),4==i.receiptType&&(e.typeRoleTitle="补卡类型:",e.receiptCauseTitle="补卡事由:"),e.form=t.data.data}}))},submit:function(){var t=this,i=this.form2.auditCause;return"reject"===this.btnType?i?void(0,a.receiptReject)({receiptId:this.receiptId,auditCause:i}).then((function(i){t.$refs.uToast.show({message:i.data.msg,type:"success"}),setTimeout((function(){e.redirectTo({url:"../oabills/oabills?who=you"})}),1500),t.formShow=!1})).catch((function(e){t.$refs.uToast.show({message:r.data.msg,type:"error"})})):this.$refs.uToast.show({message:"请填写拒绝原因",type:"error"}):i?void(this.leave>0&&!this.nextAuditEmpId?this.$refs.uToast.show({message:"请选择审批人",type:"error"}):(0,a.receiptAgree)({auditCause:i,receiptId:this.receiptId,nextAuditEmpId:this.nextAuditEmpId}).then((function(i){t.$refs.uToast.show({message:i.data.msg,type:"success"}),t.formShow=!1,setTimeout((function(){e.redirectTo({url:"../oabills/oabills?who=you"})}),2e3)})).catch((function(e){t.$refs.uToast.show({message:e,type:"error"})}))):this.$refs.uToast.show({message:"请填写审批意见",type:"error"})},nextAuditEmpClick:function(){var t={};t.empId=this.form.empId,t.typeRoleId=this.form.typeRoleId,t.who=this.who,t.id=this.id,e.navigateTo({url:"../selectedEmp/selectedEmp?come=details&form=".concat(JSON.stringify(t))})},backClick:function(){e.navigateTo({url:"../oabills/oabills?who=".concat(this.who)})}}};t.default=c}).call(this,i("543d")["default"])},"83a0":function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return n}));var n={uIcon:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(i.bind(null,"1e79"))},myCard:function(){return i.e("components/my-card").then(i.bind(null,"2227"))},uCellGroup:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-cell-group/u-cell-group")]).then(i.bind(null,"f7ef"))},uCell:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-cell/u-cell")]).then(i.bind(null,"0137"))},uImage:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-image/u-image")]).then(i.bind(null,"a083"))},myTimeAxis:function(){return i.e("components/my-time-axis").then(i.bind(null,"405c"))},uAvatar:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-avatar/u-avatar")]).then(i.bind(null,"b1e7"))},myButton:function(){return i.e("components/my-button").then(i.bind(null,"e84c"))},uPopup:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(i.bind(null,"3d93"))},uForm:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-form/u-form")]).then(i.bind(null,"ff33"))},uFormItem:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-form-item/u-form-item")]).then(i.bind(null,"f4f7"))},uInput:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-input/u-input")]).then(i.bind(null,"f18a"))},"u-Textarea":function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u--textarea/u--textarea")]).then(i.bind(null,"433b"))},uButton:function(){return Promise.all([i.e("common/vendor"),i.e("uni_modules/uview-ui/components/u-button/u-button")]).then(i.bind(null,"2e7d"))},uToast:function(){return i.e("uni_modules/uview-ui/components/u-toast/u-toast").then(i.bind(null,"b688"))}},r=function(){var e=this,t=e.$createElement,i=(e._self._c,e.form.jbTimeSteps&&e.form.jbTimeSteps.length>0&&3==e.form.receiptType),n=i?e.__map(e.form.jbTimeSteps,(function(t,i){var n=e.__get_orig(t),r=t.dayDate&&t.dayDate.substr(0,10);return{$orig:n,g1:r}})):null,r=e.form.receiptImgs.length,o=e.form.receiptTogether.length,u=e.form.empName&&e.form.empName.substr(e.form.empName.length-2),a=e.form.createTime.substr(5,11),s=e.__map(e.form.auditEmps,(function(t,i){var n=e.__get_orig(t),r=t.empName?t.empName&&t.empName.substr(t.empName.length-2):null,o=3==t.auditStatus||4==t.auditStatus?t.auditTime.substr(5,11):null;return{$orig:n,g6:r,g7:o}})),c=e.nextAuditEmpId?e.nextAuditEmpName&&e.nextAuditEmpName.substr(e.nextAuditEmpName.length-2):null,m=e.form.duplicateEmps.length,p=e.__map(e.form.duplicateEmps,(function(t,i){var n=e.__get_orig(t),r=t.empName&&t.empName.substr(t.empName.length-2);return{$orig:n,g10:r}})),l=e.__map(e.form.receiptTogether,(function(t,i){var n=e.__get_orig(t),r=t.empName&&t.empName.substr(t.empName.length-2);return{$orig:n,g11:r}}));e._isMounted||(e.e0=function(t){e.togetherShow=!0},e.e1=function(t){e.togetherShow=!1}),e.$mp.data=Object.assign({},{$root:{g0:i,l0:n,g2:r,g3:o,g4:u,g5:a,l1:s,g8:c,g9:m,l2:p,l3:l}})},o=[]},9725:function(e,t,i){"use strict";i.r(t);var n=i("58f8"),r=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(o);t["default"]=r.a},b30a:function(e,t,i){},cbfb:function(e,t,i){"use strict";var n=i("b30a"),r=i.n(n);r.a},ed56:function(e,t,i){"use strict";(function(e,t){var n=i("4ea4");i("5495");n(i("66fd"));var r=n(i("3724"));e.__webpack_require_UNI_MP_PLUGIN__=i,t(r.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])}},[["ed56","common/runtime","common/vendor","pageKq/common/vendor"]]]);